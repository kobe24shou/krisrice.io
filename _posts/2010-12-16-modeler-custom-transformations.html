---
layout: post
title: Modeler Custom Transformations
date: '2010-12-16T14:02:00.000-08:00'
author: Kris Rice
tags: 
modified_time: '2010-12-16T14:08:17.474-08:00'
thumbnail: http://3.bp.blogspot.com/_HTPuwjEAZfk/TQqL2m2yjlI/AAAAAAAAAXw/w8s8M8bLIeY/s72-c/Capturewho.PNG
blogger_id: tag:blogger.com,1999:blog-37621059.post-6725469318593340027
blogger_orig_url: http://krisrice.blogspot.com/2010/12/modeler-custom-transformations.html
---

This is a follow up to the transformation I mentioned <a href="http://krisrice.blogspot.com/2010/10/30-modeler-sneak-peak-transformations.html">earlier</a>&nbsp;where I mentioned how to write custom transformation in javascript for the design. &nbsp;This is based on a java's pluggable script which means almost anything can be plugged in instead of javascript. &nbsp;See <a href="https://scripting.dev.java.net/">here </a>for details on the available languages. <br /><br />This is the&nbsp;beginning&nbsp;of what I plan on building up over time which is a library of functions for use to make custom script very easily. &nbsp;This is an example of adding the standard who columns to every table in the model. &nbsp;&nbsp;&nbsp; <br /><br />The first two functions are to delete and add columns to a table. <br /><br /><pre class="brush: javascript">// import actual java classes for use later<br />importPackage(javax.swing);<br />// variable to keep a status message for later<br />var msg="";<br />/*<br />  Delete function takes in the table and name of the column to delete<br />*/<br /><br />function deleteColumn(table,colName){ <br />    columns = table.getElements();<br /> <br /> // iterate columns looking for the one to remove<br />    for (var i = 0; i &lt; columns.length; i++) {<br /> if ( columns[i].getName().toUpperCase() == colName ){<br />   columns[i].remove();<br />   msg += "Deleted from "+ table.getName() + " : " + colName + "\n"; <br />        }<br />  }<br />}<br />/*<br />  checkOrCreate function takes in the table and name of the column to add. This checks for the existence of the column before addin<br />*/<br /><br />function checkOrCreate(table,colName,typeName,typeSize){ <br /> hasCol = false;<br /> columns = table.getElements();<br /> <br /> for (var i = 0; i &lt; columns.length; i++) {<br /> column = columns[i];<br /> if ( column.getName().toUpperCase() == colName ){<br />   hasCol=true;<br /> }<br /> }<br />  // if the column is not present add it<br />  if (! hasCol ) {<br />      newCol = table.createColumn();<br />      newCol.setName(colName);<br />      newCol.setUse(1);<br />   // lookup the logical datatype based on the name<br />   type = model.getDesign().getLogicalDatatypeSet().getLogTypeByName(typeName);<br />      newCol.setLogicalDatatype(type);<br />      if (typeSize != null  ) {<br />        newCol.setDataTypeParameter("size",typeSize);<br />      }<br />      msg += "Added to "+ table.getName() + " : " + colName+ "\n";<br /> }  <br />}<br /><br />// grab all the table in the model as an array<br />tables = model.getTableSet().toArray();<br /><br />for (var t = 0; t &lt; tables.length;t++){<br /> // remove all these from the table<br /> deleteColumn(tables[t],"CREATED_BY");<br /> deleteColumn(tables[t],"CREATED_ON");<br /> deleteColumn(tables[t],"UPDATED_BY");<br /> deleteColumn(tables[t],"UPDATED_ON");<br /> <br /> // add them back with the specified datatypes<br /> checkOrCreate(tables[t],"CREATED_BY",   "VARCHAR",200);<br /> checkOrCreate(tables[t],"CREATED_ON",   "DATE");<br /> checkOrCreate(tables[t],"UPDATED_BY",   "VARCHAR",200);<br /> checkOrCreate(tables[t],"UPDATED_ON",   "DATE");<br />}<br /><br />// notify the user what happened<br />JOptionPane.showMessageDialog(null, msg);<br /></pre><br />The end result of running this will be a dialog that shows all the actions performed.  <br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_HTPuwjEAZfk/TQqL2m2yjlI/AAAAAAAAAXw/w8s8M8bLIeY/s1600/Capturewho.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_HTPuwjEAZfk/TQqL2m2yjlI/AAAAAAAAAXw/w8s8M8bLIeY/s1600/Capturewho.PNG" /></a></div><br />