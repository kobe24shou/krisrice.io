---
layout: post
title: Profiling a Java + JDBC Application
date: '2017-07-12T07:57:00.002-07:00'
author: Kris Rice
tags: 
modified_time: '2017-07-12T07:57:15.930-07:00'
thumbnail: https://1.bp.blogspot.com/-D12SdSoHv0Y/WWYnsNKIKmI/AAAAAAAABSU/aar8qUcFnvEnqB4RMacpSfXS9A42PLpQQCK4BGAYYCw/s72-c/Screen%2BShot%2B2017-07-12%2Bat%2B9.43.33%2BAM.png
blogger_id: tag:blogger.com,1999:blog-37621059.post-2199978538108102449
blogger_orig_url: http://krisrice.blogspot.com/2017/07/profiling-java-jdbc-application.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><h2 style="text-align: left;">NetBeans</h2><br />First, there's NO Java coding needed nor Java source code needed to profile a Java program this way. &nbsp;NetBeans added this a while back up I just found it recently. &nbsp;The ability to attach to any Java program and profile the SQL going across JDBC. The dev team's blog on it is here:&nbsp;<a href="http://jj-blogger.blogspot.nl/2016/05/netbeans-sql-profiler-take-it-for-spin.html">http://jj-blogger.blogspot.nl/2016/05/netbeans-sql-profiler-take-it-for-spin.html</a><br /><br /><br /><h2 style="text-align: left;">SQLcl</h2>SQLcl is our Java library for scripting sql/sql scripts that has been in SQLDev since day 0 back in '05/06. &nbsp;We factored that and wrapped a cmd line around it. &nbsp;This makes it easier to test for features, regressions, performance,.... &nbsp;as well to give a new cmd line with extended features. &nbsp;This library is also what performs the Grid Infra installs these days as well embedded in Oracle REST Data Services. It's quite proven and tested. This is all Java bases using plain JDBC to talk to the database. &nbsp;It's no different than any java based application which means anything done to profile it is applicable to any java program like say sqldev , ords, custom jdbc , any java program.<br /><br /><a href="http://1.bp.blogspot.com/-D12SdSoHv0Y/WWYnsNKIKmI/AAAAAAAABSU/aar8qUcFnvEnqB4RMacpSfXS9A42PLpQQCK4BGAYYCw/s1600/Screen%2BShot%2B2017-07-12%2Bat%2B9.43.33%2BAM.png" imageanchor="1"><img border="0" height="322" src="https://1.bp.blogspot.com/-D12SdSoHv0Y/WWYnsNKIKmI/AAAAAAAABSU/aar8qUcFnvEnqB4RMacpSfXS9A42PLpQQCK4BGAYYCw/s640/Screen%2BShot%2B2017-07-12%2Bat%2B9.43.33%2BAM.png" width="640" /></a><br /><br /><br /><h2 style="text-align: left;">Profiling</h2><br />This new feature in Netbeans is very simple to use and there's no need to have the sources of the jsvs code. &nbsp;Off the Profile menu - &gt; Attach to External Process<br /><br /><a href="http://3.bp.blogspot.com/-aKH-VRJISjw/WWYoSSiVbPI/AAAAAAAABSc/qZIxxQH54vs2VszlR3Wcv1L9FOrcmYg6wCK4BGAYYCw/s1600/Screen%2BShot%2B2017-07-12%2Bat%2B9.46.31%2BAM.png" imageanchor="1"><img border="0" height="312" src="https://3.bp.blogspot.com/-aKH-VRJISjw/WWYoSSiVbPI/AAAAAAAABSc/qZIxxQH54vs2VszlR3Wcv1L9FOrcmYg6wCK4BGAYYCw/s320/Screen%2BShot%2B2017-07-12%2Bat%2B9.46.31%2BAM.png" width="320" /></a><br /><br /><br /><br /><br />Then set the Profile to SQL Queries<br /><a href="http://2.bp.blogspot.com/-LysEXXESdt4/WWYooSv0MSI/AAAAAAAABSk/61m3IKfRLlYWI7W7ue9msYLwGjP3-RzywCK4BGAYYCw/s1600/Screen%2BShot%2B2017-07-12%2Bat%2B9.47.55%2BAM.png" imageanchor="1"><img border="0" height="320" src="https://2.bp.blogspot.com/-LysEXXESdt4/WWYooSv0MSI/AAAAAAAABSk/61m3IKfRLlYWI7W7ue9msYLwGjP3-RzywCK4BGAYYCw/s320/Screen%2BShot%2B2017-07-12%2Bat%2B9.47.55%2BAM.png" width="226" /></a><br /><br />Click Attach, which shows a list of running java processes. &nbsp;This is what SQLcl will look like.<br /><br /><a href="http://4.bp.blogspot.com/-XxGnp_GFR5M/WWYo1-ZAtvI/AAAAAAAABSs/rClfSX5ZV0Ya2DH1lFwmLnoWJ0zhd8kfACK4BGAYYCw/s1600/Screen%2BShot%2B2017-07-12%2Bat%2B9.48.47%2BAM.png" imageanchor="1"><img border="0" height="384" src="https://4.bp.blogspot.com/-XxGnp_GFR5M/WWYo1-ZAtvI/AAAAAAAABSs/rClfSX5ZV0Ya2DH1lFwmLnoWJ0zhd8kfACK4BGAYYCw/s640/Screen%2BShot%2B2017-07-12%2Bat%2B9.48.47%2BAM.png" width="640" /></a><br /><br /><br /><br /><h2 style="text-align: left;">Running the Program</h2>Now once JDBC traffic starts being issued, it's captured with timings and occurrences of that statement along with the Java stack for where the call originated. Next up is the hardest part, what the heck does all this data mean? When is fast , fast enough? <br /><br /><h2 style="text-align: left;">What to change?</h2><br />Below is what an APEX install looks like on my laptop during the middle of the process. &nbsp;There's a lot of data to look at. The slowest statement is the dbms registry validation. Is that bad, can it be sped up? Probably not. The most called is the check for DBMS_OUPUT. Can that be reduced? Also, probably not.<br /><br />This is when knowledge of the code and intended actions are critical. &nbsp;For me, getting SQLcl the program from 19m down to 7m was fast enough. That was done with <b>zero</b> changes to the APEX install scripts but just from watching the traffic going to the database and analyzing that. <br /><br />Change #1 : SQLcl was name resolving every create or replace &lt;PLSQL OBJECT&gt; then checking for errors on that object. &nbsp;Much faster is to simply check count(1) from user_errors without the name resolution. &nbsp;When there's no errors in the user_errors table, there's no need to name resolve. So that entire path was shortened. &nbsp;It's visible in this stack with the 1,106 time "select count(1) cnt from user_errors" was called. &nbsp;<br /><br />Change #2: DBMS_OUTPUT was being called after any/all commands to the database. That was reduced to only calls that could invoke some output. For Example, alter session doesn't need to be checked. That change reduced the number of db calls being issued at all. Fastest call is the ones you don't make.<br /><br />and on and on.<br /><br /><u>Nothing is more important than the knowledge of the intended outcome.</u><br /><br /><br /><a href="http://2.bp.blogspot.com/-_0g5uhGR2_o/WWYplGf5T3I/AAAAAAAABS0/XZEln9jSS0Mn07vntzA_BOiQ4sOmcvFwwCK4BGAYYCw/s1600/Screen%2BShot%2B2017-07-12%2Bat%2B9.51.42%2BAM.png" imageanchor="1"><img border="0" height="412" src="https://2.bp.blogspot.com/-_0g5uhGR2_o/WWYplGf5T3I/AAAAAAAABS0/XZEln9jSS0Mn07vntzA_BOiQ4sOmcvFwwCK4BGAYYCw/s640/Screen%2BShot%2B2017-07-12%2Bat%2B9.51.42%2BAM.png" width="640" /></a><br /><br /><br /><br /><br /><br /></div>