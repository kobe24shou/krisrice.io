---
layout: post
title: Adding mail processing to your database app
date: '2010-11-11T15:07:00.000-08:00'
author: Kris Rice
tags: 
modified_time: '2010-11-11T15:07:48.262-08:00'
thumbnail: http://3.bp.blogspot.com/_HTPuwjEAZfk/TNx1zMBhTRI/AAAAAAAAAXQ/uQZ9NR4VDjc/s72-c/hudson_promed.PNG
blogger_id: tag:blogger.com,1999:blog-37621059.post-1886626403793232342
blogger_orig_url: http://krisrice.blogspot.com/2010/11/adding-mail-processing-to-your-database.html
---

&nbsp;&nbsp; I'm not sure how many people know that part of the APEX team, Sharon Kennedy,&nbsp;&nbsp;runs&nbsp;<a href="http://promedmail.org/">ProMedmail</a>&nbsp;&nbsp;which is probably one of the scariest and most active internet APEX applications. &nbsp;It is "The global electronic reporting system for outbreaks of emerging infectious diseases &amp; toxins, open to all sources." &nbsp;So by a&nbsp;scary&nbsp;APEX app I mean you can get your latest updates on <a href="http://promedmail.org/pls/apex/f?p=2400:1001:::NO::F2400_P1001_BACK_PAGE,F2400_P1001_PUB_MAIL_ID:1000,85769">Anthrax in Bangladesh</a>,&nbsp;<a href="http://promedmail.org/pls/apex/f?p=2400:1001:::NO::F2400_P1001_BACK_PAGE,F2400_P1001_PUB_MAIL_ID:1010,85751">Dengue Fever</a>&nbsp;, and about everything else going on in the world.<br /><br />&nbsp;&nbsp;The reason the "mail" part is in the name is that as you may have guess it's a mail list which anyone can subscribe to <a href="http://promedmail.oracle.com/pls/otn/f?p=2400:1900:4287768289244330:::::#question2">here</a>. &nbsp; It ends up on the website by some custom code that reads the an inbox and inserts that into a table in the database which is then exposed by APEX. &nbsp;I've taken that&nbsp;custom code and made it quite generic. &nbsp;I'm going to make this&nbsp;available&nbsp;on &nbsp;samplecode.oracle.com in a project named email2sql so http://email2sql.samplecode.oracle.com. &nbsp;This is working and it's a really easy way to add email processing to any application.<br /><br />To try this out there's just a couple steps.<br />1) Checkout the <a href="https://email2sql.samplecode.oracle.com/source/browse/email2sql/trunk/">project</a><br />2) Edit the settings.xml for email and sql<br />2.5) &nbsp;If you use the tables in the settings.xml already create the table with the mail.sql<br />3) Run "ant run" &nbsp;( if you need ant it's at&nbsp;http://ant.apache.org/bindownload.cgi )<br /><br /><br />In the settings.xml is 2 entries sql and attachment.sql, these control what to do and have all the binds&nbsp;available&nbsp;in the example. &nbsp;This can be plsql instead of sql also.<br /><br /><pre class="brush: xml;">&lt;entry key="sql"&gt;<br /> insert into mail(id,to_address,subject,msg_body,rcvd_date,sent_date,msgid,from_address) <br />values(:ID,:TO_ADDRESS,:SUBJ,:BODY,:RCVD_DATE,:SENT_DATE,:MSGID,:FROM_ADDRESS)&lt;/entry&gt;<br />&lt;entry key="attachment.sql"&gt;<br />insert into mail_attachments(id,content,filename,content_type,content_size) <br />values(:ID,:CONTENT,:FILENAME,:CONTENT_TYPE,:CONTENT_SIZE)&lt;/entry&gt;<br /></pre><br />Also for Promedmail we use <a href="http://hudson-ci.org/">hudson</a> to schedule this to run every 5 minutes. &nbsp;If you've not looked into hudson it's very simple to get started with also. &nbsp;I did a talk on this back in Feb at RMOUG. &nbsp;But more on that later.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_HTPuwjEAZfk/TNx1zMBhTRI/AAAAAAAAAXQ/uQZ9NR4VDjc/s1600/hudson_promed.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_HTPuwjEAZfk/TNx1zMBhTRI/AAAAAAAAAXQ/uQZ9NR4VDjc/s1600/hudson_promed.PNG" /></a></div><br />Please let me know of any issues or suggestions.