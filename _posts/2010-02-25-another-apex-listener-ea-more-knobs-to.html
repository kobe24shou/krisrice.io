---
layout: post
title: Another APEX Listener EA - More knobs to turn
date: '2010-02-25T15:52:00.000-08:00'
author: Kris Rice
tags: 
modified_time: '2010-02-25T15:52:43.596-08:00'
thumbnail: http://farm4.static.flickr.com/3402/3564913819_f70012a8fe_t.jpg
blogger_id: tag:blogger.com,1999:blog-37621059.post-3277091635869885607
blogger_orig_url: http://krisrice.blogspot.com/2010/02/another-apex-listener-ea-more-knobs-to.html
---

There's a <a href="http://www.oracle.com/technology/products/database/application_express/html/apex_listener_download.html">new listener EA released today</a> go grab it and try out.&nbsp; There's 2 real changes.&nbsp; First the MIME_TYPE on file uploads is fixed.&nbsp;<br /><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://farm4.static.flickr.com/3402/3564913819_f70012a8fe.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="213" src="http://farm4.static.flickr.com/3402/3564913819_f70012a8fe.jpg" width="320" /></a></div><br />&nbsp;The second is a result of sitting down at RMOUG last week and talking over the excel parsing with <a href="http://spendolini.blogspot.com/2010/02/uploading-xls-files-with-apex-listener.html">Scott</a>.&nbsp;&nbsp; That conversation resulted in a few new knobs to change some configuration options.&nbsp;<br /><br /><br />1) I found an API which takes the item_id and gives back the item_name so the collection will default to the ITEM_NAME of the file upload item.<br /><br />2) Files ending with .xls OR .xlsx will be processed.<br /><br />3) Several new configuration choices:<br />&nbsp; a) First is a new config option to have 1 sheet of the workbook per collection.&nbsp; This is controlled by<br /> &lt;entry key="apex.excel2collection.onecollection"&gt;true|false&lt;/entry&gt;<br /><br />&nbsp;&nbsp; b) Then, you can essentially hard code a collection name to be used for all excel uploads.<br /> &lt;entry key="apex.excel2collection.name"&gt;MY_COLLECTION_NAME&lt;/entry&gt; <br /><br />&nbsp;&nbsp; c)&nbsp; Lastly, an option to use the sheet name vs. a sequential WORKSHEET:1,2,3....<br /> &lt;entry key="apex.excel2collection.useSheetName"&gt;true|false&lt;/entry&gt;<br /><br />So, here's a recap of excel parsing with the APEX Listener<br /> <br />Step 1: Turn it on<br />&nbsp;&nbsp;&nbsp; &lt;entry key="apex.excel2collection"&gt;true&lt;/entry&gt;<br />Step 2:<br />&nbsp;&nbsp;&nbsp; The request of the upload must be : xls2collection<br /><br />This will get you ONE collection which contains all sheets in the workbook and the collection will be named the APEX Item name.<br /><br />Options:<br />To have ONE collection per sheet: <br /><br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;entry key="apex.excel2collection.onecollection"&gt;false&lt;/entry&gt;<br /><br />To have a sequential sheet name vs. the sheet name from excel. <br />&nbsp;&nbsp;&nbsp; &lt;entry key="apex.excel2collection.useSheetName"&gt;false&lt;/entry&gt;<br /><br />To specify the name of the collection for ALL collections created via Excel upload<br /> <br />&nbsp;&nbsp;&nbsp; &lt;entry key="apex.excel2collection.name"&gt;MY_COLLECTION_NAME&lt;/entry&gt;<br /> <br /><br />The results of all of these upload are a collection which is formed as this:<br />The default of just turning it on will look like this.<br /> <br />CollectionName - Item Name <br />C001&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - Sheet Name<br />C002..N &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - Data from the worksheet<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_HTPuwjEAZfk/S4cIVeXrl9I/AAAAAAAAAUA/5cMpnWzs7OE/s1600-h/excel2collection.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="248" src="http://2.bp.blogspot.com/_HTPuwjEAZfk/S4cIVeXrl9I/AAAAAAAAAUA/5cMpnWzs7OE/s640/excel2collection.PNG" width="640" /></a></div><br />