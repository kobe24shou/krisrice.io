---
layout: post
title: Application Express and Anonymous Blocks
date: '2009-12-17T13:20:00.000-08:00'
author: Kris Rice
tags: 
modified_time: '2009-12-17T13:20:46.623-08:00'
thumbnail: http://4.bp.blogspot.com/_HTPuwjEAZfk/Syqb-PzzPrI/AAAAAAAAAR8/8zWBCRjqFio/s72-c/apexRefactor002.jpg
blogger_id: tag:blogger.com,1999:blog-37621059.post-9023177034093126877
blogger_orig_url: http://krisrice.blogspot.com/2009/12/application-express-and-anonymous.html
---

Almost every application I've written in Application Express seems to end up with anonymous PL/SQL blocks.&nbsp; In the best practices <a href="http://www.oracle.com/technology/pub/articles/wootton-apex-bps.html">document</a> , this is called out as something to avoid doing.&nbsp; The document mentions reuse and reuse and manageability.&nbsp; Manageability includes things like running your logic within a debugger or in a <a href="http://www.oracle.com/technology/obe/11gr2_db_prod/appdev/sqldev/sqldev_unit_test/sqldev_unit_test_otn.htm">Unit Test</a> as part of a regression test.&nbsp; There's also one more thing that is not mention which is performance.&nbsp; The performance impact has been reduced with the latest versions of the database however a stored procedure is faster.&nbsp; <br /><br />So, now introduce <a href="http://www.oracle.com/technology/software/products/sql/index.html">SQL Developer 2.1</a>.&nbsp; We added the ability to re-factor those anonymous blocks into a PL/SQL package. <br /><br />Now when you right click on an application you get a new "Refactor (in bulk)" option.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_HTPuwjEAZfk/Syqb-PzzPrI/AAAAAAAAAR8/8zWBCRjqFio/s1600-h/apexRefactor002.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_HTPuwjEAZfk/Syqb-PzzPrI/AAAAAAAAAR8/8zWBCRjqFio/s400/apexRefactor002.jpg" /></a><br /></div><br />When you choose this, the tool will work for a little bit trying to figure out things like binds for in and out, data types for those params, and so on.&nbsp; You'll see a worksheet open and the code will start appearing in it as it's working.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_HTPuwjEAZfk/Syqb_N3GD2I/AAAAAAAAASE/3EXiJA_IIu0/s1600-h/apexRefactor004.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_HTPuwjEAZfk/Syqb_N3GD2I/AAAAAAAAASE/3EXiJA_IIu0/s400/apexRefactor004.jpg" /></a><br /></div><br />Once it's completed, you'll see a package spec with comments on where that procedure came from.&nbsp; This includes the page ID, page name, and process name.&nbsp; These are to make it easy to find that process and replace it with the plsql call.&nbsp; The comment also says "SUGGESTED CALL TO PLACE INTO THE PROCESS"&nbsp; this is suggested because there could be many reason you want to alter the suggestion.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_HTPuwjEAZfk/SyqcAJpWemI/AAAAAAAAASM/PZ8mSFZxbew/s1600-h/apexRefactor005.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_HTPuwjEAZfk/SyqcAJpWemI/AAAAAAAAASM/PZ8mSFZxbew/s400/apexRefactor005.jpg" /></a><br /></div><br />Now if you scroll down, the body of the package is there also.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_HTPuwjEAZfk/SyqcBHF0wzI/AAAAAAAAASU/qV1C5TgLKfQ/s1600-h/apexRefactor006.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_HTPuwjEAZfk/SyqcBHF0wzI/AAAAAAAAASU/qV1C5TgLKfQ/s400/apexRefactor006.jpg" /></a><br /></div><br /><br />Hopefully, this will give you a jump start on moving those anonymous blocks into store procedures.