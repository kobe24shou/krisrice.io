---
layout: post
title: 'How to add an NCSA style Access Log to ORDS Standalone '
date: '2017-01-12T07:32:00.002-08:00'
author: Kris Rice
tags: 
modified_time: '2017-01-12T07:32:37.425-08:00'
blogger_id: tag:blogger.com,1999:blog-37621059.post-1465713544209445243
blogger_orig_url: http://krisrice.blogspot.com/2017/01/how-to-add-ncsa-style-access-log-to.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><h3 style="text-align: left;">What ORDS Standalone is</h3><br />&nbsp;&nbsp; &nbsp; ORDS Standalone webserver which is Eclipse Jetty,&nbsp;https://eclipse.org/jetty/ . &nbsp;For the standalone, ORDS sends output to STDOUT, it runs on the command line. &nbsp;That means there's nothing like a control commands like startup, shutdown,status nor log files, access logs. &nbsp;It's bare bones intentionally to get up and running fast. &nbsp;Then it's recommended for anything with lots of volume more to a more full featured webserver like Tomcat or WLS.<br /><br /><br /><h3 style="text-align: left;">Standalone Startup</h3>&nbsp; &nbsp; With all that said, it is quite simple to use the standalone for most cases. &nbsp;When doing this the most important thing is just a startup script so that when the machine/db starts the ORDS instance starts also. &nbsp;There's an init.d script in this blog post that can be used and adjusted as needed :&nbsp;<a href="http://krisrice.blogspot.com/2010/12/listener-startupshutdown-script.html">http://krisrice.blogspot.com/2010/12/listener-startupshutdown-script.html</a><br /><br /><br /><h3 style="text-align: left;">Standalone Access Logs</h3>&nbsp; The other thing much needed from a standalone instance of ORDS would be an access log to see what it's getting for traffic. &nbsp;Here's where being Jetty based is a great thing.<br /><br />&nbsp; This is documented for some solaris workaround only so probably missed by most. &nbsp;ORDS Standalone allows for customization of the Jetty server itself. &nbsp;Looking at the ords configuration directory there's a &lt;path&gt;/standalone. &nbsp;This will have a file named standalone.properties which looks like this which is the name/value pairs of what ORDS will configure.<br /><br /><pre style="brush: shell;">#Thu Jan 12 09:56:19 EST 2017<br />jetty.port=8081<br />standalone.access.log=/tmp/ords_log<br />standalone.context.path=/ords<br />standalone.doc.root=/Users/klrice/workspace_ords_3.0.x/klr_vm_config/ords/standalone/doc_root<br />standalone.scheme.do.not.prompt=true<br />standalone.static.context.path=/i<br />standalone.static.do.not.prompt=true<br />standalone.static.path=/Users/klrice/workspace/apex_trunk/images<br /></pre><br />Jetty is configurable by xml documents and the documentation has some really good example of what's possible. &nbsp;This blog post is going to focus on the Access Log section here: https://eclipse.org/jetty/documentation/current/configuring-jetty-request-logs.html<br /><br />In that same directory, create a folder named "etc" and in there create a file named "jetty-http.xml" . Then drop this into the file<br /><br /><pre style="brush: xml;">&lt;?xml version="1.0"?&gt;<br />&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure.dtd"&gt;<br />&lt;Configure id="Server" class="org.eclipse.jetty.server.Server"&gt;<br />    &lt;Ref id="Handlers"&gt;<br />      &lt;Call name="addHandler"&gt;<br />        &lt;Arg&gt;<br />          &lt;New id="RequestLog" class="org.eclipse.jetty.server.handler.RequestLogHandler"&gt;<br />        &lt;Set name="requestLog"&gt;<br />          &lt;New id="RequestLogImpl" class="org.eclipse.jetty.server.NCSARequestLog"&gt;<br />        &lt;Set name="filename"&gt;&lt;Property name="jetty.logs" default="<b>/tmp/</b>"/&gt;<b>ords-access-yyyy_mm_dd.log</b>&lt;/Set&gt;<br />        &lt;Set name="filenameDateFormat"&gt;yyyy_MM_dd&lt;/Set&gt;<br />        &lt;Set name="retainDays"&gt;90&lt;/Set&gt;<br />        &lt;Set name="append"&gt;true&lt;/Set&gt;<br />        &lt;Set name="extended"&gt;false&lt;/Set&gt;<br />        &lt;Set name="logCookies"&gt;false&lt;/Set&gt;<br />        &lt;Set name="LogTimeZone"&gt;GMT&lt;/Set&gt;<br />          &lt;/New&gt;<br />        &lt;/Set&gt;<br />      &lt;/New&gt;<br />        &lt;/Arg&gt;<br />      &lt;/Call&gt;<br />    &lt;/Ref&gt;<br />&lt;/Configure&gt;<br /><br /></pre><br /><br />Now when ORDS is started again you'll have a file that was specified in the xml file. &nbsp;This example is&nbsp;<span style="background-color: rgba(0 , 0 , 0 , 0.901961); color: #28fe14; font-family: &quot;andale mono&quot;; font-size: 12px;">&nbsp;</span><span style="background-color: rgba(0 , 0 , 0 , 0.901961); color: #28fe14; font-family: &quot;andale mono&quot;; font-size: 12px;">/tmp/ords-access-2017_01_12.log</span><span style="background-color: rgba(0 , 0 , 0 , 0.901961); color: #28fe14; font-family: &quot;andale mono&quot;; font-size: 12px;">&nbsp;</span>&nbsp;with an normal NCSA/Apache looking access log.<br /><br /><pre style="brush: log;">0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:32 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:33 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:33 +0000] "GET /ords/klrice/test/morse?text=3362 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:33 +0000] "GET /ords/klrice/test/morse?text=5728 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx.%29%29%22%29.%28%2C%27%2C HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%27jSwGPl%3C%27%22%3EbBKXcr HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%29%20AND%208651%3D9722%20AND%20%289950%3D9950 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%29%20AND%203741%3D3741%20AND%20%285130%3D5130 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%20AND%204853%3D4504 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%20AND%203741%3D3741 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%27%29%20AND%201525%3D5863%20AND%20%28%27aKGY%27%3D%27aKGY HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%27%29%20AND%203741%3D3741%20AND%20%28%27jcNS%27%3D%27jcNS HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%27%20AND%204691%3D5794%20AND%20%27rhDV%27%3D%27rhDV HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:34 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%27%20AND%203741%3D3741%20AND%20%27FJPb%27%3D%27FJPb HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:35 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%25%27%20AND%206423%3D5178%20AND%20%27%25%27%3D%27 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:35 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%25%27%20AND%203741%3D3741%20AND%20%27%25%27%3D%27 HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:35 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%20AND%209677%3D8181--%20embz HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:35 +0000] "GET /ords/klrice/test/morse?text=de%20n1jlx%20AND%203741%3D3741--%20ldng HTTP/1.1" 200 - <br />0:0:0:0:0:0:0:1 -  -  [12/Jan/2017:15:22:35 +0000] "GET /ords/klrice/test/morse?text=%28SELECT%20%28CASE%20WHEN%20%284135%3D9257%29%20THEN%204135%20ELSE%204135%2A%28SELECT%204135%20FROM%20INFORMATION_SCHEMA.PLUGINS%29%20END%29%29 HTTP/1.1" 200 - <br /><br /></pre><br /><br /><br /><h3 style="text-align: left;">Summary</h3>Here's the simple steps:<br />1- mkdir &lt;ords config directory&gt;/standalone/etc<br />2- vi jetty-http.xml<br />3- paste the above xml file and adjust the log location<br />4- Restart ORDS<br /><br /></div>