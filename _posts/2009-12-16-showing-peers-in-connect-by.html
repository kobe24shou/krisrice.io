---
layout: post
title: Showing Peers in a Connect by
date: '2009-12-16T17:12:00.000-08:00'
author: Kris Rice
tags: 
modified_time: '2009-12-16T17:12:35.830-08:00'
thumbnail: http://1.bp.blogspot.com/_HTPuwjEAZfk/Syl8AfBYfOI/AAAAAAAAARs/HF-hpeKaQMk/s72-c/emp_hier.PNG
blogger_id: tag:blogger.com,1999:blog-37621059.post-6237888346645786549
blogger_orig_url: http://krisrice.blogspot.com/2009/12/showing-peers-in-connect-by.html
---

I built a system internally a while ago and one of the most popular pages was one that showed a tree of data. We even got accused of caching the page because it was too dynamic and fast.&nbsp; Here's what I did and what the output ended up like.<br /><br />In SQL Developer: <br /><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_HTPuwjEAZfk/Syl8AfBYfOI/AAAAAAAAARs/HF-hpeKaQMk/s1600-h/emp_hier.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_HTPuwjEAZfk/Syl8AfBYfOI/AAAAAAAAARs/HF-hpeKaQMk/s640/emp_hier.PNG" /></a><br /></div>&nbsp;<br />In Application Express:&nbsp; The leading &nbsp; gets highlighted as part of the link but I'm sure there CSS wizards that could fix that.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_HTPuwjEAZfk/SymEbwR3uBI/AAAAAAAAAR0/lcqijiOYQ1k/s1600-h/emp_apex.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_HTPuwjEAZfk/SymEbwR3uBI/AAAAAAAAAR0/lcqijiOYQ1k/s640/emp_apex.PNG" /></a><br /></div><br />And try it <a href="http://apex.oracle.com/pls/otn/f?p=27403:2">here</a><br /><br /><br /><pre>with q as (  select level lvl,empno<br />      from emp e<br />      connect by prior empno  = mgr<br />      start with empno = 7839   ) <br />select SYS_CONNECT_BY_PATH(sub.ename,'/'),LPAD(' ',((18*(level-1))+1),'&nbsp;') ||sub.ename,sub.empno,sal,comm,d.dname<br />from dept d,(<br />    select e.* <br />    from emp e<br />    connect by prior mgr=empno<br />    start with empno = 7566</pre><pre>union <br />    select e.* <br />    from emp e<br />    where level = (select lvl from q where empno = 7566 ) <br />    connect by prior empno = mgr<br />    start with empno = 7839<br /> union <br />    select e.* <br />    from emp e<br />    where mgr = 7566<br />  ) sub    <br />where d.deptno = sub.deptno  <br />connect by prior empno  = mgr<br />start with empno = 7839  <br /></pre><br /><br />Once it breaks down it's quite simple.&nbsp; The inner unions are<br />1) The parents of the interesting record<br />2) The peers of the interesting record<br />3) The children of the interesting record<br /><br />Then put the outer connect by and you have what I got.