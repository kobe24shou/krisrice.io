---
layout: post
title: Wonder twin powers activate!
date: '2006-03-03T15:08:00.000-08:00'
author: Kris Rice
tags: 
modified_time: '2006-11-15T15:33:11.124-08:00'
blogger_id: tag:blogger.com,1999:blog-37621059.post-116363267517057630
blogger_orig_url: http://krisrice.blogspot.com/2006/03/wonder-twin-powers-activate.html
---

Form of an Application, Form of a debugger..<br /><br />The standard manner to debug any <a href="http://www.oracle.com/technology/products/database/application_express/index.html">APEX</a> application is done with wwv_flow.debug which execute when the page is run by a developer in debug.  Wouldn't it be nice to have a full stack of the code executing with inspection?  Read on to see how to initiate a full debug session in SQL Developer from an APEX based application.<br /><br /><br />There's some setup involved the form of persmission which have to be granted to the user who owns the code as well as the user who is configured to run APEX.<br /><br />First grant the ability to connect a debug session to the parse_as in APEX.  In this case klrice.<br />SQL> grant DEBUG CONNECT SESSION to klrice;<br />Grant succeeded.<br /><br />Second grant the ability to debug to the user configured to run APEX in mod_plsql.  Since I'm using XE as my example it's public.  <br />SQL> grant debug on klrice.ls to public;<br />Grant succeeded.<br /><br /><br />Now everything is setup and on to the APEX application.  This is a very simple example but should show enough of how to make it more generic.<br /><br />Here's a screenshot of my page.<br /><br /><img alt="apex_page.png" src="http://www.orablogs.com/krice/archives/apex_page.png" width="352" height="412" border="0" /><br /><br />There is nothing special in the plsql region except it's a plsql region running a very small procedure name LS which loops and does a HTP.P.  This procedure needs to be compiled for debug.<br /><br />Next there's a checkbox for flagging when to connect for debugging and not.  Then the real debugger code is in the Processes.  The first is a Before Header to be able to debug anything executed on the page.  This process is conditional based ont he value of the P1_DEBUG checkbox as follows:<br /><br />  dbms_debug_jdwp.connect_tcp('localhost',4000);<br /><br />While localhost is hardcoded something like owa_util.get_cgi_env('REMOTE_ADDR') could be used to make it more generic.  Also note the port is hardcoded to 4000 , this is important in a sec.<br /><br />Since the debugger would now be connected, it's nice to disconnect so that's done like this in the After Footer Process:<br /><br />   dbms_debug_jdwp.disconnect;<br />   :P1_DEBUG := 'N';<br /><br /><br />I've also reset the value of P1_DEBUG to force the checkbox to be choosen each time.<br /><br /> Now into SQL Developer.  Right Click on the connection to the user which is the same as the APEX application and choose Remote Debug<br /><img alt="sdev_context_menu.png" src="http://www.orablogs.com/krice/archives/sdev_context_menu.png" width="357" height="250" border="0" /><br /><br /><br />Now to bring it all together.  Run the application check the checkbox to start the debugger.<br /><br />This is what should result in SQL Developer:<br /><img alt="apex_debug.png" src="http://www.orablogs.com/krice/archives/apex_debug.png" width="1214" height="910" border="0" /><br /><br />I hope this helps in the much enjoyed task of bug fixing.