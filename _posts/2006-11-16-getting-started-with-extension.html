---
layout: post
title: Getting started with an Extension
date: '2006-11-16T21:21:00.001-08:00'
author: Kris Rice
tags:
- Extensions
modified_time: '2006-11-17T11:32:57.103-08:00'
blogger_id: tag:blogger.com,1999:blog-37621059.post-8919268067615283516
blogger_orig_url: http://krisrice.blogspot.com/2006/11/getting-started-with-extension.html
---

<p><br />Sue had <a href="http://sueharper.blogspot.com/2006/08/lets-get-started-with-extension-for.html">blogged</a> on how to get an extension started in jdev in 10 steps.  In the presentation at OOW, I showed how little code it could take to start an extension and said we'd get a skeleton out of how to start one yourself. Well here's the <a href="http://esdev.svn.sourceforge.net/viewvc/esdev/trunk/org.esdev/skeleton/">Skeleton</a> and here's a <a href="http://esdev.sourceforge.net/sqldev_skeleton.zip">zip</a> of it.  With this skeleton, there's 3 steps to getting started with an extension.<br /></p><p><br />Step 1: Download the <a href="http://esdev.sourceforge.net/sqldev_skeleton.zip">zip</a>.<br /><br />Step 2: Got to [unziped location]/etc and update the contents of the build.properties.  Here's the content of the file and the <strong>only </strong>line that has to be updated is the sdev.home which points to your install of SQL Developer 1.1<br /></p><p style="text-indent:40pt;"><br />   build.dir=built<br /><br />   sdev.home=/Users/klrice/Documents/workspace/raptor_trunk/ide<br /><br />   extension.id=sample.skeleton<br /><br />   extension.name=Skeleton Sample<br /><br />   extension.author=Kris Rice<br /><br />   extension.author.url=http://krisrice.blogspot.com<br /><br />   extension.descr=A Skeleton of an extension<br /><br />   update.url=http://esdev.sf.net<br /></p><p><br />Step 3: Run ant deploy<br /></p><p><br />Well it's done and deployed to your local copy of sqldeveloper.  Wasn't that easy and painless? :-) Take a look at the Help-&gt;About and the Extensions tab will show the name from Step2.<br /></p><p><br /><a href="http://photos1.blogger.com/blogger2/3395/4592/1600/skel_ext_about.png"><img style="cursor: pointer;" src="http://photos1.blogger.com/blogger2/3395/4592/320/skel_ext_about.png" alt="" border="0" /></a><br /></p><p><br />This added 2 things. First an <strong>ls</strong> command when a script is run ( F5 ).  Second a <strong>Reconnect </strong>on the connection. Here's a screen capture of both.<br /></p><p><br /><a href="http://photos1.blogger.com/blogger2/3395/4592/1600/skel_ext_results.png"><img style="cursor: pointer;" src="http://photos1.blogger.com/blogger2/3395/4592/320/skel_ext_results.png" alt="" border="0" /></a><br /></p><p><br />In case you didn't look in the source of the extension, it adds 2 things. First just like in the OOW presentation I mentioned there's a new hook in the scripting engine which allows custom command to be added.  In this case we add <strong>ls </strong>as a command <a href="http://esdev.svn.sourceforge.net/viewvc/esdev/trunk/org.esdev/skeleton/src/sample/LS.java?revision=23&amp;view=markup">here</a>. This extends the abstract class CommandListener which has a few methods:<br /></p><pre><br />public abstract class CommandListener {<br /><br />    public abstract boolean handleEvent(Connection conn, ScriptRunnerContext ctx, SQLCommand cmd);<br /><br />    public abstract void beginEvent(Connection conn, ScriptRunnerContext ctx, SQLCommand cmd);<br /><br />    public abstract void endEvent(Connection conn, ScriptRunnerContext ctx, SQLCommand cmd);<br /><br />    public void beginScript(Connection conn, ScriptRunnerContext ctx, SQLCommand[] cmd){<br />    }<br /><br />    public  void endScript(Connection conn, ScriptRunnerContext ctx, SQLCommand[] cmd){        <br />    }<br />}<br /></pre><p><br /><span style="font-family:Arial;font-size:10pt;">}<br /><br /></span><br /><br />By implementing and registering a command listener, an extension writer has the ability to add new command and listen in on when commands are run as scripts.  Hopefully the names on the methods are pretty simple. The beginScript is before anything is run and endScript is after everything.   The other 3 are before each command, after each command and the command itself.<br /></p><p><br />So in this case I only implemented the handleEvent so I could process the ls then finally return a true to say I did something.<br /></p><pre><br />public boolean handleEvent(Connection conn, ScriptRunnerContext ctx, SQLCommand cmd) {<br />   44         ResultSet rs = null;<br />   45         if (cmd.getSql().equals("ls")) {<br />....<br />   68             return true;<br />   69         }<br />   70         return false;<br />   71     }<br /></pre><p><br />The second extension for the <strong>Reconnect</strong> has been explained <a href="http://krisrice.blogspot.com/2006/11/xml-extension-points-context-menus.html">here</a> and <a href="http://krisrice.blogspot.com/2006/05/xml-based-right-click-menus.html">here</a>.  What's new in this example is that the xml references a java class: className="sample.ReconnectAction"  .  This class extends another abstract here :<br /></p><pre><br />public abstract class AbstractMenuAction { <br />   public abstract void launch(); <br />   public abstract void setArgs(String args); <br />} <br /></pre><p><br />In this launch, all we did was get a handle to the connection which will cause the framework to reconnect if the connection was dropped and put a status out to the toolbar.<br /></p><pre>  // get the connection <br />  // this will force a reconnect<br />  getDBObject().getDatabase().getConnection();<br />  // status basr entry<br />  Ide.getStatusBar().setText("Reconnected.");<br /></pre><p><br />Now that everyone knows how to get started with extension, we should see lots of cool stuff.  When you <span style="text-decoration:underline;"><strong>do</strong></span> create an extension drop Sue or myself a note and we'll add it to the list of known <a href="http://www.oracle.com/technology/products/database/sql_developer/files/extensions.htm">extensions</a>.<br /></p>