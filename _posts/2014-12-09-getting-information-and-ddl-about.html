---
layout: post
title: Getting DDL for objects with sdsql
date: '2014-12-09T04:23:00.002-08:00'
author: Kris Rice
tags:
- sdsql
- sqlcl
modified_time: '2016-06-10T13:03:58.817-07:00'
blogger_id: tag:blogger.com,1999:blog-37621059.post-3605005349375016053
blogger_orig_url: http://krisrice.blogspot.com/2014/12/getting-information-and-ddl-about.html
---

Getting ddl out for any object is quite simple. &nbsp;You can just call dbms_metadata with something nice and easy like select dbms_metata.get_ddl('TABLE','EMP') from dual;<br /><br /><pre class="brush: sql">SQL&gt;  select dbms_metadata.get_ddl('TABLE','EMP') from dual;<br /><br />DBMS_METADATA.GET_DDL('TABLE','EMP')<br />--------------------------------------------------------------------------------<br /><br />  CREATE TABLE "KLRICE"."EMP"<br />   ( "EMPNO" NUMBER(4,0) NOT NULL ENABLE,<br /> "ENA<br /><br />SQL&gt;<br /><br /></pre>Now you are all set and go create a table right ? Not really. The easiest part is setting pages or set long to get the full output. &nbsp;The hard part is getting the dependent objects like triggers.<br /><br /><br />Now introducing the new DDL command<br /><pre class="brush: sql">KLRICE@ORCL&gt;ddl emp<br /><br />  CREATE TABLE "KLRICE"."EMP" <br />   ( "EMPNO" NUMBER(4,0) NOT NULL ENABLE, <br /> "ENAME" VARCHAR2(10), <br /> "JOB" VARCHAR2(9), <br /> "MGR" NUMBER(4,0), <br /> "HIREDATE" DATE, <br /> "SAL" NUMBER(7,2), <br /> "COMM" NUMBER(7,2), <br /> "DEPTNO" NUMBER(2,0), <br /> "MYCLOB" CLOB, <br />  PRIMARY KEY ("EMPNO")<br />  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS <br />  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645<br />  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1<br />  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)<br />  TABLESPACE "SYSTEM"  ENABLE, <br />  FOREIGN KEY ("MGR")<br />   REFERENCES "KLRICE"."EMP" ("EMPNO") ENABLE, <br />  FOREIGN KEY ("DEPTNO")<br />   REFERENCES "KLRICE"."DEPT" ("DEPTNO") ENABLE<br />   ) SEGMENT CREATION IMMEDIATE <br />  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 <br /> NOCOMPRESS LOGGING<br />  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645<br />  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1<br />  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)<br />  TABLESPACE "SYSTEM" <br /> LOB ("MYCLOB") STORE AS BASICFILE (<br />  TABLESPACE "SYSTEM" ENABLE STORAGE IN ROW CHUNK 8192 RETENTION <br />  NOCACHE LOGGING <br />  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645<br />  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1<br />  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) <br /><br /><b>  CREATE OR REPLACE EDITIONABLE TRIGGER "KLRICE"."EMP_TRG1" <br />before insert on emp<br />for each row<br />begin<br />    if :new.empno is null then<br />        select emp_seq.nextval into :new.empno from dual;<br />   end if;<br />end;<br /><br /><br />ALTER TRIGGER "KLRICE"."EMP_TRG1" ENABLE</b><br />KLRICE@ORCL&gt;<br /></pre><br /><br /><h4>Too much details?</h4><br />This is still using dbms_metadata underneath it so you can adjust the output by setting some transformation parameters on metadata. &nbsp;For example:<br /><br /><pre class="brush:sql">KLRICE@ORCL&gt;host cat examples/ddl_emp.sql<br />begin<br />     dbms_metadata.set_transform_param (dbms_metadata.session_transform,'STORAGE',false);<br />     dbms_metadata.set_transform_param (dbms_metadata.session_transform,'TABLESPACE',false);<br />     dbms_metadata.set_transform_param (dbms_metadata.session_transform,'SEGMENT_ATTRIBUTES', false);<br />     dbms_metadata.set_transform_param (dbms_metadata.session_transform,'REF_CONSTRAINTS', false);<br />     dbms_metadata.set_transform_param (dbms_metadata.session_transform,'CONSTRAINTS', false);<br />     dbms_metadata.set_transform_param (dbms_metadata.session_transform, 'SQLTERMINATOR', true);<br /><br />  end;<br />/<br /><br />ddl emp<br />KLRICE@ORCL&gt;@examples/ddl_emp.sql<br />anonymous block completed<br /><br />  CREATE TABLE "KLRICE"."EMP" <br />   ( "EMPNO" NUMBER(4,0), <br /> "ENAME" VARCHAR2(10), <br /> "JOB" VARCHAR2(9), <br /> "MGR" NUMBER(4,0), <br /> "HIREDATE" DATE, <br /> "SAL" NUMBER(7,2), <br /> "COMM" NUMBER(7,2), <br /> "DEPTNO" NUMBER(2,0), <br /> "MYCLOB" CLOB<br />   ) ;<br /><br />  CREATE OR REPLACE EDITIONABLE TRIGGER "KLRICE"."EMP_TRG1" <br />before insert on emp<br />for each row<br />begin<br />    if :new.empno is null then<br />        select emp_seq.nextval into :new.empno from dual;<br />   end if;<br />end;<br /><br /><br />/<br />ALTER TRIGGER "KLRICE"."EMP_TRG1" ENABLE;<br />KLRICE@ORCL&gt;<br /><br /></pre><br />But wait I have an Application Express Application I need the 'ddl' for that too.  Give this a try.<br /><br /><pre class="brush:sql">OBE@ORCL&gt;apex export 100<br />&lt;&lt;&lt; LOTS AND LOTS OF TEXT WILL PRINT &gt;&gt;</pre><br /><br /><br />Now couple these with spool and you have a sql script to get objects with dependencies and the apex application that goes with it all.<br /><br /><br /><pre class="brush:sql">OBE@ORCL&gt;spool mybuild.sql<br />OBE@ORCL&gt;ddl emp<br />OBE@ORCL&gt;ddl dept<br />OBE@ORCL&gt;apex export 100<br />OBE@ORCL&gt;spool off</pre><br />