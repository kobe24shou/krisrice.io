---
layout: post
title: APEX Listener PL/SQL Validations
date: '2013-01-11T09:28:00.000-08:00'
author: Kris Rice
tags:
- ords
modified_time: '2015-07-14T08:47:52.531-07:00'
blogger_id: tag:blogger.com,1999:blog-37621059.post-7291119892424492764
blogger_orig_url: http://krisrice.blogspot.com/2013/01/apex-listener-plsql-validations.html
---

There's a 2 ways to lockdown which applications/URLS are accessible for any APEX installation with the APEX Listener.<br /><br />First, I showed the new javascript method in the 2nd half of this <a href="http://krisrice.blogspot.com/2012/12/apex-listener-20.html">post</a>. &nbsp;This is very nice as it stops any database communication at all.<br /><br />Now let's talk about the PL/SQL validation function and the part that I forgot to document. &nbsp;The normal &nbsp;PL/SQL Validation that has been in mod_plsql for a long time is supported. &nbsp;With that method, you have a function that takes in a varchar and returns a boolean if it's allowed or not. &nbsp;The input is the last portion of the URI. &nbsp;That means for Application Express it would be something like "f" or "wwv_flow.show". &nbsp;This works great if you want to allow or deny an entry point.<br /><br /><pre class="brush:sql">function authorize(<br />&nbsp; &nbsp; procedure_name in varchar2)<br />&nbsp; &nbsp; return boolean;<br /></pre><br />The bind is assumed in this case and not needed in the configuration. &nbsp;The config file for this would look like this<br /><pre class="brush:sql">&lt;entry key="apex.security.requestValidationFunction"&gt;<br />authorize<br />&lt;/entry&gt;</pre><br />The new way is similar however you can reference some bind values. &nbsp;This offer more&nbsp;flexibility&nbsp;on which&nbsp;web server&nbsp;which Application Express applications are allowed on.<br /><br />Let's take and example of 1 Application Express install where there is a public application ( app id 123 ) and an admin application ( app id 456) . &nbsp;For security reasons, the admin application is not to be accessible to the internet. &nbsp;The following function would only allow app id 123 and allow all others be blocked.<br /><br /><pre class="brush:sql">create or replace function is_allowed(<br />    flow_id in varchar2,<br />    page_id in varchar2)<br />    return boolean as<br />begin<br />   if ( flow_id = 123 ) then<br />      return true;<br />   end if;<br />   return false;<br />end;<br />/ <br />show errors</pre><br /><br />The configuration for this would look like:<br /><br /><pre class="brush:sql">&lt;entry key="apex.security.requestValidationFunction"&gt;<br />is_allowed(flow_id=&gt;:P_FLOW_ID,page_id=&gt;:P_FLOW_STEP_ID)<br />&lt;/entry&gt;</pre><br />There Apex Listener looks for the bind and puts them in automatically when referenced. &nbsp;The full list&nbsp;available&nbsp;is:<br /><div class="p1"><span class="s1">&nbsp;:</span>URL,&nbsp;:PROCNAME<span class="s1">, </span>:P_FLOW_ID , :P_FLOW_STEP_ID, :P_INSTANCE, :P_PAGE_SUBMISSION_ID , :P_REQUEST"<span class="s1">&nbsp; &nbsp;&nbsp;</span></div><div class="p1"><br />Now that the external webserver is setup and locked down to only our 123 application. &nbsp;There is another Apex Listener installed on an internal webserver. &nbsp;This internal install could run with no function at all and that would allow all applications to be accessible.<br /><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><br /></div>