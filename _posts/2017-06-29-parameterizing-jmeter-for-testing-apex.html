---
layout: post
title: Parameterizing Jmeter for testing APEX
date: '2017-06-29T12:56:00.000-07:00'
author: Kris Rice
tags: 
modified_time: '2017-06-29T12:56:31.867-07:00'
thumbnail: https://2.bp.blogspot.com/-MEgG-54ZfLY/WVVXhzTHDoI/AAAAAAAABQY/rXZFhNNz3zs724WkhPHVnVBXDeyA9E6ewCK4BGAYYCw/s72-c/Screen%2BShot%2B2017-06-29%2Bat%2B3.39.33%2BPM.png
blogger_id: tag:blogger.com,1999:blog-37621059.post-2201363649738151960
blogger_orig_url: http://krisrice.blogspot.com/2017/06/parameterizing-jmeter-for-testing-apex.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on">A while ago we needed to stress a system by using the APEX Brookstrut demo application. &nbsp;The obvious choice for this was Jmeter. &nbsp;How to setup Jmeter to record web traffic by becoming a web proxy is very known and well written process. &nbsp;Anyone that hasn't seen it, <a href="https://jmeter.apache.org/usermanual/jmeter_proxy_step_by_step.pdf">check this PDF</a> and you can see how easy it is. There were a couple issues to get around. First importing the application again and again which may get a different Application ID with each import. Next is the hostname and port may change depending on the environment. Then there's using the same session ID in apex to avoid generating a new session more than needed.<br /><br />That led to this setup.<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><a href="http://2.bp.blogspot.com/-MEgG-54ZfLY/WVVXhzTHDoI/AAAAAAAABQY/rXZFhNNz3zs724WkhPHVnVBXDeyA9E6ewCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.39.33%2BPM.png" imageanchor="1"><img border="0" src="https://2.bp.blogspot.com/-MEgG-54ZfLY/WVVXhzTHDoI/AAAAAAAABQY/rXZFhNNz3zs724WkhPHVnVBXDeyA9E6ewCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.39.33%2BPM.png" /></a></div><h3 style="text-align: left;">Configuration</h3>The first 3 parts are for tracking the cookies, any http header but most important is the User Defined section. In here, I defined variables for the webserver ( aka ORDS ) hostname/port and protocol also the APEX application ID and the Home Page for the test.<br /><br /><br /><a href="http://4.bp.blogspot.com/--wIaNKQfWeU/WVVYg85h5bI/AAAAAAAABQw/JmT86RmJm8IcEdc8J1ZEm62j-ckANkIHwCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.43.46%2BPM.png" imageanchor="1"><img border="0" src="https://4.bp.blogspot.com/--wIaNKQfWeU/WVVYg85h5bI/AAAAAAAABQw/JmT86RmJm8IcEdc8J1ZEm62j-ckANkIHwCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.43.46%2BPM.png" /></a><br /><br /><br /><br />The next step down is to define the HTTP Request Defaults. This is where the user variables start to come into play as you can see. The servername/port/protocol are all referencing the variables from above.<br /><br /><a href="http://2.bp.blogspot.com/-rt45zWslR-M/WVVZAQNFwVI/AAAAAAAABQ4/9y6dCbVGNrg2t3AIPfw-E03oGKVe9mLDACK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.45.00%2BPM.png" imageanchor="1"><img border="0" src="https://2.bp.blogspot.com/-rt45zWslR-M/WVVZAQNFwVI/AAAAAAAABQ4/9y6dCbVGNrg2t3AIPfw-E03oGKVe9mLDACK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.45.00%2BPM.png" /></a><br /><br /><br /><br /><br /><h3 style="text-align: left;">Initial Request</h3>The next part of the test is to hit the home page of the application with a bogus session ID. This kicks apex into creating a real session ID.<br /><br /><br /><a href="http://1.bp.blogspot.com/--rBQrJZeqvk/WVVZaV1IRtI/AAAAAAAABRA/bODaCTIqr1kbutl1mqvl7c5mxrzp3WBhgCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.47.15%2BPM.png" imageanchor="1"><img border="0" src="https://1.bp.blogspot.com/--rBQrJZeqvk/WVVZaV1IRtI/AAAAAAAABRA/bODaCTIqr1kbutl1mqvl7c5mxrzp3WBhgCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.47.15%2BPM.png" /></a><br /><br /><br /><br />Now to get that session ID for later I put in the JSR 223 Post Processor seen in the tree right below the test.<br /><br /><a href="http://2.bp.blogspot.com/-9wWdfxTenns/WVVZ0tDAEyI/AAAAAAAABRI/q9TtH3KFYccptdCHPhTB9-2XUghnQKb3ACK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.49.18%2BPM.png" imageanchor="1"><img border="0" src="https://2.bp.blogspot.com/-9wWdfxTenns/WVVZ0tDAEyI/AAAAAAAABRI/q9TtH3KFYccptdCHPhTB9-2XUghnQKb3ACK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.49.18%2BPM.png" /></a><br /><br /><br />The actual javascript for the test is in this Gist:<br /><script src="https://gist.github.com/krisrice/1dedd080b09f24d80cdd7fc5925fdd3e.js"></script></div><br /><br />The javascript is extracting the p_instance, p_flow_id,... which you see at the bottom of the script. &nbsp;These are then placed into the dictionary for all subsequent requests to reference.<br /><br /><br />Now the only task left is to go to the recorded test an replace all the recorded parameters which are hardcoded to specific flowid, sessionid,.. and replace them with the variables from the dictionary. &nbsp;For example this shows the ${p_flow_id} and ${_instance}<br /><br /><br /><a href="http://4.bp.blogspot.com/-FoKrxJgY7zo/WVVaX37Rh9I/AAAAAAAABRQ/1SpfLHeb3f0PRbSfvsv7-7Z_zsYv5q0swCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.51.18%2BPM.png" imageanchor="1"><img border="0" src="https://4.bp.blogspot.com/-FoKrxJgY7zo/WVVaX37Rh9I/AAAAAAAABRQ/1SpfLHeb3f0PRbSfvsv7-7Z_zsYv5q0swCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.51.18%2BPM.png" /></a><br /><br /><br />Now there's a recorded parameterized test that can be changed to point to any installation of an application quite easily.<br /><br /><br /><a href="http://3.bp.blogspot.com/-sLa9963l17M/WVVbMbAW2bI/AAAAAAAABRY/zPwetPW6K5QSTdoA2h72f0qFd_zgcqSdwCK4BGAYYCw/s1600/Screen%2BShot%2B2017-06-29%2Bat%2B3.54.19%2BPM.png" imageanchor="1"><img border="0" height="478" src="https://3.bp.blogspot.com/-sLa9963l17M/WVVbMbAW2bI/AAAAAAAABRY/zPwetPW6K5QSTdoA2h72f0qFd_zgcqSdwCK4BGAYYCw/s640/Screen%2BShot%2B2017-06-29%2Bat%2B3.54.19%2BPM.png" width="640" /></a><br /><br /></div>