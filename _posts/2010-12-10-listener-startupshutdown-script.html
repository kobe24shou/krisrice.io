---
layout: post
title: APEX Listener startup/shutdown script
date: '2010-12-10T11:56:00.000-08:00'
author: Kris Rice
tags: 
modified_time: '2010-12-10T12:13:03.508-08:00'
blogger_id: tag:blogger.com,1999:blog-37621059.post-568860005198683153
blogger_orig_url: http://krisrice.blogspot.com/2010/12/listener-startupshutdown-script.html
---

<a href="http://dpeake.blogspot.com/">David </a>asked me for a way to keep the listener up and running when a box is rebooted.&nbsp; There may very well be better ways to do this but this script can be used to start, stop, get status, and tail the log file.&nbsp; Also it can be dropped in as an init.d script to have the Listener start when the box starts.&nbsp; Since we don't have access to init.d for David's case, we are just going to put in a cron job to check status and start if not already going.&nbsp; The start function checks to ensure it's not already running before trying to start it up.&nbsp; You should be able to use this but just changing the location variables in the top of the file.<br /><br />The one addition over a normal init.d is the log command I added ( which is very simple).&nbsp; Just do ./listener.sh log and it will tail the log file.<br /><br /><br /><pre class="brush: shell;">#!/bin/sh<br />#<br />. /etc/rc.d/init.d/functions<br />NAME="Oracle Application Express Listener"<br />JAVA="/my/install/path/to/jdk/jre/bin/java"<br />APEXWAR="/my/install/path/to/apex_listener/apex.war"<br /><br /><br />OPTIONS="-Xmx1024m -Xms256m  -jar $APEXWAR"<br /><br />LOGFILE=/tmp/apex_listener.log<br />PIDFILE=/tmp/apex_listener.pid<br />start() {<br />        echo -n "Starting $NAME: "<br />        if [ -f $PIDFILE ]; then<br />                PID=`cat $PIDFILE`<br />                echo APEX Listener already running: $PID<br />                exit 2;<br />        else<br />                nohup $JAVA $OPTIONS 2&gt;&amp;1 &gt; $LOGFILE  &amp;<br />                RETVAL=$!<br />                echo Started PID: $RETVAL<br />                echo<br />                echo $RETVAL &gt;&gt;$PIDFILE<br />                return $RETVAL<br />        fi<br /><br />}<br /><br />status() {<br />        echo -n "Status $NAME: "<br />        if [ -f $PIDFILE ]; then<br />                PID=`cat $PIDFILE`<br />                echo APEX Listener already running: $PID<br />                ps -ef | grep $PID<br />        else<br />                echo APEX Listener not running<br />        fi<br />}<br /><br />stop() {<br />        if [ -f $PIDFILE ]; then<br />                PID=`cat $PIDFILE`<br />                echo -n "Shutting down $NAME "<br />                echo<br />                kill $PID<br />                rm -f $PIDFILE<br />        else<br />                echo APEX Listener not running<br />        fi<br />        return 0<br />}<br /><br />log() {<br />        tail -f $LOGFILE<br />}<br /><br />case "$1" in<br />    start)<br />        start<br />        ;;<br />    stop)<br />        stop<br />        ;;<br />    status)<br />        status<br />        ;;<br />    restart)<br />        stop<br />        start<br />        ;;<br />    log)<br />        log<br />        ;;<br />    *)<br />        echo "Usage:  {start|stop|status|restart|log}"<br />        exit 1<br />        ;;<br />esac<br />exit $?<br /></pre><br />